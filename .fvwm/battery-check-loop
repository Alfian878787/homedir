#!/bin/bash

cd /sys/class/power_supply

while true
do
    content=""
    for bat in BAT*
    do
        source <(sed "s/=/='/;s/$/'/" "$bat/uevent")
        if [ "$(cat AC/online)" != "1" -a \
             "$POWER_SUPPLY_STATUS" != "Charging" -a \
             "$POWER_SUPPLY_STATUS" != "Full" -a \
             "$POWER_SUPPLY_CAPACITY" -lt 10 ]
        then
            content="$content
$bat $POWER_SUPPLY_STATUS $POWER_SUPPLY_CAPACITY%"
        fi
    done
    if [ -n "$content" ]
    then
        notify-send "Battery Low:$content"
    fi
    sleep 60
done
