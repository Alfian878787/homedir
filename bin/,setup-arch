#!/bin/bash
#
# Groups expected: base base-devel xorg

pacman -S --needed \
    pkgfile ecryptfs-utils \
    b43-fwcutter networkmanager network-manager-applet \
    polkit-gnome gnome-keyring libgnome-keyring xfce4-notifyd \
    blueman bluez \
    pulseaudio pulseaudio-alsa \
    aspell aspell-en emacs zsh \
    git perl-term-readkey subversion \
    apache curl wget \
    encfs mosh openssh sshfs \
    lsof mlocate strace \
    python2 python3 sqlite swig \
    autocutsel evince fvwm geeqie gimp redshift slim trayer i3lock \
    ttf-inconsolata ttf-ubuntu-font-family \
    chromium flashplugin

# add pam lines about encrypted homedir

# automatically switch to newly-connected devices
# load-module module-switch-on-connect

systemctl enable NetworkManager.service
systemctl enable slim.service
usermod -a -G rfkill brandon

if [ "$1" = "dev" ]
then
    pacman -S --needed \
        libmemcached python2-lxml postgresql postgresql-libs ruby tk

    if [ ! -d /var/lib/postgres/data ]
    then
        chown postgres.postgres /var/lib/postgres
        su - postgres -c \
            "initdb --locale en_US.UTF-8 -D '/var/lib/postgres/data'"
        systemctl start postgresql.service
        su - postgres -c "createuser -d -r brandon"
    fi

    systemctl enable postgresql.service
fi
